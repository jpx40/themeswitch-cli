WHITESPACE = _{ " " | "\t" }

val   = @{ "\"" ~ char+ ~ "\"" }
value =  { ("\"" ~ char* ~ "\"") }

// char = { ASCII_ALPHANUMERIC | "." | "_" | "/" }

// string = @{ "'" ~ ("''" | (!"'" ~ ANY))* ~ "'" }
// string = @{ ("'" ~ ("''" | (!"'" ~ ANY))* ~ "'") | ("\"" ~ ("\"\"" | (!"\"" ~ ANY))* ~ "\"") }

string = ${ "\"" ~ inner ~ "\"" }
inner  = @{ char* }
char   =  {
    !("\"" | "\\") ~ ANY
  | "\\" ~ ("\"" | "\\" | "/" | "b" | "f" | "n" | "r" | "t")
  | "\\" ~ ("u" ~ ASCII_HEX_DIGIT{4})
}
object =  {
    "{" ~ "}"
  | "{" ~ pair ~ ("," ~ pair)* ~ "}"
}
pair   =  { string ~ ":" ~ value }

array = {
    "[" ~ "]"
  | "[" ~ string ~ ("," ~ string)* ~ "]"
}

COMMENT = _{ "#" ~ (!"\n" ~ ANY)* }

name = { "name" ~ "=" ~ string }

param = { "param" ~ (NEWLINE)* ~ ("{" ~ NEWLINE* ~ (path | object) ~ NEWLINE* ~ "}" ~ NEWLINE*) }

path = { "path" ~ "=" ~ string }

cmd = { ("cmd" ~ "=" ~ string) }

arg       = { "arg" ~ "=" ~ array }
import    = { "import" ~ "=" ~ char+ }
wallpaper = { ("wallpaper" ~ "{" ~ (path | array) ~ "}") }
out       = { "output" ~ "=" ~ val }
script    = { "script" ~ "{" ~ (NEWLINE)* ~ (path ~ (NEWLINE)* | param ~ (NEWLINE)* | arg ~ (NEWLINE)*)+ ~ (NEWLINE)* ~ "}" }
exec      = { "exec" ~ "{" ~ (NEWLINE)* ~ (path ~ (NEWLINE)* | cmd ~ (NEWLINE)* | param ~ (NEWLINE)* | arg ~ (NEWLINE)*)+ ~ (NEWLINE)* ~ "}" }
template  = { "template" ~ "{" ~ (NEWLINE)* ~ (path ~ (NEWLINE)* | param ~ (NEWLINE)* | out ~ (NEWLINE)* | arg ~ (NEWLINE)* | color ~ NEWLINE*)+ ~ (NEWLINE)* ~ "}" }
color     = { "color" ~ "{" ~ (NEWLINE)* ~ object ~ (NEWLINE)* ~ "}" }
profile   = { "profile" ~ "{" ~ (NEWLINE)* ~ (name) ~ NEWLINE* ~ (script ~ NEWLINE* | wallpaper ~ (NEWLINE)* | exec ~ NEWLINE* | template ~ NEWLINE* | color ~ NEWLINE* | variable ~ NEWLINE*)+ ~ (NEWLINE)* ~ "}" }

variable = { ("\"$" ~ "=" ~ string) }

file = {
    SOI ~ (NEWLINE)* ~ (import ~ NEWLINE* | variable ~ NEWLINE* | profile ~ NEWLINE*)* ~ (NEWLINE)* ~ EOI
}
